name: Build-WePE-ISO

on:
  workflow_dispatch:

jobs:
  build:
    runs-on: windows-latest

    steps:
    - name: Checkout
      uses: actions/checkout@v4

    - name: Download WePE installer
      run: |
        curl -L -o wepe.exe https://www.wepe.com.cn/download/WePE64_V2.3.exe

    - name: Extract WePE installer
      run: |
        7z x wepe.exe -oextract

    - name: Generate ISO
      run: |
        cd extract
        # 微PE官方支持命令行生成 ISO
        .\WePE.exe /ISO

    - name: Upload ISO to Release
      uses: softprops/action-gh-release@v2
      with:
        files: extract\*.iso
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}